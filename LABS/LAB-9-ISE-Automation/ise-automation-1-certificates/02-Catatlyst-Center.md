# Catalyst Center Certificate Setup

## Overview

Cisco Catalyst Center uses certificates primarily to establish a secure and trusted environment between the Catalyst Center server, northbound API applications, and network devices. It allows importing and storing of certificates from a certificate authority (CA) along with private keys generated by Catalyst Center. These certificates enable HTTPS connections by confirming the server's identity and authenticating clients, ensuring encrypted and trusted communications. The process involves generating a Certificate Signing Request (CSR), submitting it to a CA for signing, and then importing the signed certificate and its chain into Catalyst Center - which is what we will accomplish in this lab module. 



## General Information

>[!WARNING]
>You must have completed [**PKI Infrastructure Setup Module**](./01-PKI-Infrastructure.md) before completing this lab module.

>[!NOTE]
>:mega: While many of these tasks can be completed with your own device, the screenshots taken (and many of the steps reference) using the Windows Jump Host. <br><br>
>:mega: The version of Catalyst Center running in the lab environment at the time of this writing (v2.3.5.6) <u>does</u> have an API to import a trusted certificate; however, unlike ISE, it <u>does not</u> have an API for generating a Certificate Signing Request (CSR) or binding that CSR to the Catalyst Center host.  For that reason, we have combined the instructions for installing the Trusted Certificate via GUI and API into this single lab module.

This lab module consists of the following tasks:

1. [**Exporting the Windows Root CA Certificate**](#exporting-the-windows-root-ca-certificate)
2. [**Installing the Root CA in Catalyst Center (GUI)**](#installing-the-root-ca-certificate-into-catalyst-center-gui)
3. [**Installing the Root CA in Catalyst Center (API)**](#installing-the-root-ca-certificate-in-catalyst-center-api)
4. [**Building the Certificate Signing Request**](#building-the-certificate-signing-request)
5. [**Signing the Catalyst Center CSR with the Certificate Authority**](#signing-the-catalyst-center-csr-with-the-certificate-authority)
6. [**Converting the Certificate Chain to PEM Format**](#converting-the-certificate-chain-to-pem-format)
7. [**Installing the Catalyst Center Certificate**](#installing-the-catalyst-center-certificate)



## Exporting the Windows Root CA Certificate

***Complete the following tasks:***

1. From the Windows Jump Box, open Chrome browser and navigate to http://198.18.133.1/certsrv/ and login with ***username: `admin`*** and ***password: `C1sco12345`*** if prompted

2. From here, click on ***Download a CA Certificate***

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-10.png?raw=true "Import JSON")

3. Since we only have a single CA in our lab environment, the only one that should show up should be "Current[CA]".  

   1. Set the ***Encoding Method*** as Base64 and 
   
   2. Click ***Download CA certificate***

   ![json](../../../ASSETS/LABS/AD/CERTS/ISE-GUI-CSR-1b.png?raw=true "Import JSON")

   You may see a prompt from the browser to ***Keep*** or ***Discard*** this download, choose ***Keep***.  By default, the file will save to the Downloads folder as `certnew.cer`

>[!IMPORTANT]
>For the next steps, please choose <u>either</u> to ***install the root CA via GUI*** or ***install the root CA via API***.  If you wish to do both for learning purposes, you will need to delete the certificate you installed from one method in order to complete the steps for the other method.

## Installing the Root CA Certificate in Catalyst Center (GUI)

***Complete the following tasks:***

1. From the Windows Jump Box, open Chrome browser and navigate to the Catalyst Center IP address of https://198.18.129.100 (or utilize the bookmark) and login using the credentials **username: `admin`** and **password: `C1sco12345`**

2. From the Catalyst Center hamburger menu in the top left, select 

   1. **System** then
   2. **Settings**

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-22.png?raw=true "Import JSON")

3. On the left, scroll down to the **Trust & Privacy** section and select **Trustpool**

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-1b.png?raw=true "Import JSON")

4. Select ***Import***

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-12.png?raw=true "Import JSON")

5. Select ***Choose a file*** and select the CA cert you downloaded from the previous task, and choose ***Import***

6. The imported CA Certificate should now be in the list:

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-13.png?raw=true "Import JSON")

## Installing the Root CA Certificate in Catalyst Center (API)

>[!NOTE]
> This section under construction, check back soon!


## Building the Certificate Signing Request 

**Complete the following tasks:**

1. These tasks assume your browser window is still open to Catalyst Center

2. From the Catalyst Center hamburger menu in the top left, select **System > Settings**

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-22.png?raw=true "Import JSON")

3. On the left, scroll down to the **Trust & Privacy** section and select **System Certificates**

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-1a.png?raw=true "Import JSON")


4. Click ***Replace Certificate*** 

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-14.png?raw=true "Import JSON")

5. Under "Add Certificate" select **Generate new CSR**

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-2.png?raw=true "Import JSON")


6. Complete the Certificate Signing Request Form as follows:

```
   Common Name = 198.18.129.100 **Note: you may have to modify this from a different IP in the lab**
   Country = United States
   Region/State = CA
   Locality = SJC
   Email = dclouduser@cisco.com
   Organizational Unit = DCLOUD
   Digest = SHA-512
   Key Length = 4096
   Key/Extended Key Usage = Leave at defaults
   Organization = CISCO
   SanDNS (Comma separated)= dnac-vip.dcloud.cisco.com, dnac.dcloud.cisco.com, pnpserver.dcloud.cisco.com, pnpserver.pnp.dcloud.cisco.com
   SanIP = 100.64.0.101, 198.18.129.100
```
7. Here is a screenshot of the completed form (below).  Click **Generate new CSR** blue button at the bottom right, this will generate the new CSR.

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-3.png?raw=true "Import JSON")


8. From here:

   1. Select **Download CSR** - which will save the file to the "Downloads" folder of the current logged in user.  
   
   2. Then click **Done**

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-4.png?raw=true "Import JSON")

## Signing the Catalyst Center CSR with the Certificate Authority

Now that we've generated and downloaded the Certificate Signing Request from Catalyst Center, we need to get it signed by the Windows Certificate Authority that we setup previously in this lab module.

**Complete the following tasks:**

1. Navigate to where the exported file was saved, right click on the .csr file that was just downloaded from Catalyst Center, and choose "Edit with Notepad++" (or your text editor of choice)

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-5.png?raw=true "Import JSON")

>[!NOTE]
>If prompted to download update packages for Notepad++, just click "No"

2. Copy the entire contents of the Notepad++ file 


3. Open a new Chrome browser tab and enter the URL `http://198.18.133.1/certsrv` and log in with the credentials **username: `admin`** and **password: `C1sco12345`**

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-9.png?raw=true "Import JSON")

4. Within the Certificate Authority Web Site navigate the following:

   1. Click Request a Certificate

      ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-10b.png?raw=true "Import JSON")

   2. Click advanced certificate request

      ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-11.png?raw=true "Import JSON")

   3. To submit the Certificate Request paste the CSR as shown

      ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-12.png?raw=true "Import JSON")

   4. **Important** Select `Cisco Server Template` for the Certificate Template and click submit

      ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-13.png?raw=true "Import JSON")

   5. On the Certificate Issued page:
      1. **Important** select **DER encoded**
      2. **Important** download from the link **Download Certificate Chain**
      3. **Important** The browser may recognize that this is a certificate file and prompt if you want to "Keep" or "Discard", select Keep.  By default the file will save as `certnew.p7b`

         ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-14.png?raw=true "Import JSON")

   6. Open the downloads folder and rename the `certnew.p7b` file to `dnac-chain.p7b` (you can name the file whatever you wish, but the screenshots below reference it as `dnac-chain.p7b` so just keep that in mind)

## Converting the Certificate Chain to PEM Format

Now that we have exported the signed certificate chain, we must convert it to a format that Catalyst Center understands.  Unfortunately, our Windows Jump Box in this lab does not have the tools installed to do this natively.  To complete this conversion, we are going to transfer the file to our Ubuntu Script Server (which runs OpenSSL), modify the file format to a .pem, and transfer the new file back to our Windows Jump Box.  Alternatively, if your device runs OpenSSL (such as on MacOS or Linux), you can use that.

**Complete the following tasks:**

   1. Open the windows command prompt `CMD` application and do the following:
      1. Change directory to the Downloads directory `cd Downloads`
      2. Check the directory to ensure the file `dnac-chain.p7b` exists via the command `dir`
      3. Copy the file to Ubuntu Script Server using scp using the following command `scp  ./dnac-chain.p7b root@198.18.134.28:/root/` 
         
         You may be prompted to verify the key fingerprint of the host - type "yes" and hit Enter

         ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-6.png?raw=true "Import JSON")
      4. When prompted the **password: `C1sco12345`** and hit Enter, the file will transfer

   2. From the dCloud Session View, select the Script Server and open the ***VM Console*** and login with ***username = `root`*** and ***password = `C1sco12345`***. 
      1. Verify the `dnac-chain.p7b` was successfully transferred by using the **ls** command.  Here we see the file has successfully transferred.

         ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-7.png?raw=true "Import JSON")

      2. Use the command `openssl pkcs7 -in dnac-chain.p7b -inform DER -out dnac-chain.pem -print_certs` and hit Enter. (Reminder, if you named the file something other than `dnac-chain.p7b` use that name here instead)

      3. Validate that the new file has been created by running the **ls** command again.  Here, we see that we now have a .pem file.

         ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-8.png?raw=true "Import JSON")

      4. You can now exit out of the Script Server window

   3. Return to the Windows Jump Box host, where your `CMD` window should still be open (if not, reopen command prompt and ensure you change to the Downloads directory again as above)
      1. Copy the new .pem file back from the Ubuntu Script Server using the following command `scp root@198.18.134.28:/root/dnac-chain.pem ./` (using whatever file name you chose)
      2. Enter the **password: `C1sco12345`** when prompted
      3. Open the Downloads folder and verify that the file now exists


Congratulations the Certificate is prepared, now we will import it into Catalyst Center.

## Installing the Catalyst Center Certificate

1. Still from the Windows Jump Box, log into Catalyst Center with the credentials **username: `admin`** and **password: `C1sco12345`** if not logged on already

2. Navigate to the Menu and then Select **System > Settings**

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-22.png?raw=true "Import JSON")

3. On the Settings page scroll on the left down to and select **System Certificates**

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-1a.png?raw=true "Import JSON")

6. On the System tab click the **Replace Certificate** button

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-24.png?raw=true "Import JSON")

7. On the **Certificates** page

   1.  Select **PEM** 
   2.  Click the link to ***Choose a file***
   3.  Select the `dnac-chain.pem` from the Downloads directory. 
   4.  When opened into the UI click the **Upload** button

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-26.png?raw=true "Import JSON")

8. Note that you may get some warning messages after uploading the cert, these can safely be ignored for the purposes this lab.

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-9.png?raw=true "Import JSON")

9. Then click **Save** and lastly **Continue**.

   ![json](../../../ASSETS/LABS/AD/CERTS/Cert-CSR-29.png?raw=true "Import JSON")

Catalyst Center will now log out. After a few minutes refresh the GUI from the browser then display the certificate within the Browser and it should look like this.

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-10.png?raw=true "Import JSON")

Under the **Details** tab under **Extensions > Certificate Subject Alternative Name** we should also find the entries below:

   ![json](../../../ASSETS/LABS/AD/CERTS/CATC-GUI-CSR-11.png?raw=true "Import JSON")


>[!NOTE]
>You'll notice that we still get certificate errors when accessing the Catalyst Center GUI from the Windows Jump Host.  This is because the Windows Jump Host is not a part of the domain and thereby does not inherently trust the certificate that Catalyst Center is presenting.  The above screenshots validate that the certificate is working correctly, though.

>[!TIP]
>In a production environment, you would likely not use the IP address to be the "Common Name" for your Certificate Signing Request.  However, due to the version of Catalyst Center currently used in the lab (v2.3.5.6-70143 as of July 2025), we must use the IP address to avoid an error message when uploading the .pem file.  This bug has been fixed as of newer versions of Catalyst Center.

Congratulations you have changed the certificate and are now ready to use DNS for discovery purposes. The Root CA may also be used in this lab for Identity Services Engine, and through a CAP Profile EAP certificates. Instructions for this setup in the next section.


> [!IMPORTANT]
> **Feedback:** If you found this set of **labs** or **content** helpful, please fill in comments on this feedback form [give feedback](https://github.com/kebaldwi/DNAC-TEMPLATES/discussions/new?category=feedback-and-ideas).</br></br>
**Content Problems and Issues:** If you found an **issue** on the **lab** or **content** please fill in an [issue](https://github.com/kebaldwi/DNAC-TEMPLATES/issues/new) include what file, along with the issue you ran into. 

> [**Continue to ISE Certificate Setup**](./03-ISE-Certificates)

> [**Return to ISE Automation Lab Overview**](../README.md)