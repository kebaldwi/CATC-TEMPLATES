## Vulnerabilities in Cisco IOS XE Software Web UI Feature

### What?

Cisco is aware of active exploitation of a previously unknown vulnerability in the web UI feature of Cisco IOS XE Software when exposed to the internet or to untrusted networks. 

This vulnerability allows a remote, unauthenticated attacker to create an account on an affected device with privilege level 15 access. The attacker can then use that account to gain control of the affected device.

### More Info?

The [**Cisco Advisory**](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z) is located in the link: [**Cisco Advisory Link**](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z)

Cisco is providing an update for the ongoing investigation into observed exploitation of the web UI feature in Cisco IOS XE Software. We are updating the list of fixed releases and adding the Software Checker.

### Software?

This is available here: [**Fixed Software**](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z#fs)

Both of these CVEs are being tracked by [**CSCwh87343**](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwh87343).

### Vulnerable Products

These vulnerabilities affect **Cisco IOS XE Software** if the web UI feature is enabled. The **web UI** feature **is enabled** through the `ip http server` or `ip http secure-server` commands.

### Products Confirmed Not Vulnerable

Cisco has confirmed that these vulnerabilities do not affect the following Cisco products:

- Adaptive Security Appliance (ASA) Software
- Firepower Threat Defense (FTD) Software
- IOS Software
- IOS XE Software prior to Release 16
- NX-OS Software

### Determine the HTTP Server Configuration

To determine whether the **HTTP Server feature** is enabled for a system, log in to the system and use the `show running-config | include ip http server|secure|active` command in the CLI to check for the presence of the `ip http server` command or the `ip http secure-server` command in the global configuration. If either command is present, the HTTP Server feature is enabled for the system.

```sh
show running-config | include ip http server|secure|active
```

The following example shows the output of the `show running-config | include ip http server|secure|active` command for a system that has the HTTP Server feature enabled:

```text
Router# show running-config | include ip http server|secure|active
ip http server
ip http secure-server
```
> [!CAUTION] 
> The presence of either command or both commands in the system configuration indicates that the web UI feature is enabled.

If the ip http server command is present and the configuration also contains ip http active-session-modules none, these vulnerabilities are not exploitable over HTTP.

If the ip http secure-server command is present and the configuration also contains ip http secure-active-session-modules none, these vulnerabilities are not exploitable over HTTPS.

### Details

The web UI is an embedded GUI-based system-management tool that provides the ability to provision the system, to simplify system deployment and manageability, and to enhance the user experience. It comes with the default image, so there is no need to enable anything or install any license on the system. The web UI can be used to build configurations as well as to monitor and troubleshoot the system without CLI expertise.

### Workarounds

There are **no workarounds** that address these vulnerabilities.

#### Options 

- **Disabling** the **HTTP Server** feature eliminates the attack vector for these vulnerabilities and may be a suitable mitigation until affected devices can be upgraded. Administrators can **disable** the **HTTP Server** feature by using the `no ip http server` and/or `no ip http secure-server` command in global configuration mode. 

   > **Note:** If **both** ***http server*** and ***http-secure server*** **are in use**, then **both** commands **are required** to disable the HTTP Server feature.

- **Limiting access** to the **HTTP Server** to **trusted networks** will limit exposure to these vulnerabilities. The following example shows how to allow remote access to the HTTP Server from the trusted 192.168.0.0/24 network:

#### Example Templates for the Vulnerability

These templates may be imported directly into Catalyst Center via the template hub or via REST-API.

1. [**Disabling HTTP Services**](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/DisableHttpHttpsServices-J2.json) - This template when deployed will disable the http and https service. 

   Link: [⬇︎DisableHttpHttpsServices-J2.json⬇︎](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/DisableHttpHttpsServices-J2.json)

   > [!IMPORTANT] 
   > If you are using Guest Services, or IOX services to manage APP Hosting or for management please consider the other alternative options.

2. [**Limiting HTTP Access**](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/LimitHttpHttpsAccess-J2.json) - This template when deployed will limit the http and https services via ACL. 

   Link: [⬇︎LimitHttpHttpsAccess-J2.json⬇︎](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/LimitHttpHttpsAccess-J2.json)

   > [!IMPORTANT] 
   > If you are managing the device via http/https, or using APP Hosting please ensure that the servers requiring access are included in the ACL. *(examples incl: ISE, Catalyst Center, etc)*

3. [**Limiting to Guest HTTP Access**](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/GuestHttpHttpsAccess-J2.json) - This template when deployed will limit the http and https services via ACL for guest services. Remember we may want to protect the device from the internet, but still offer Guest services. 
   
   Link: [⬇︎GuestHttpHttpsAccess-J2.json⬇︎](https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/kebaldwi/DNAC-TEMPLATES/blob/master/CODE/TEMPLATES/JINJA2/DAYN/GuestHttpHttpsAccess-J2.json)

   > **Note:**  If you are offering guest services via http/https portal, please ensure that the networks and servers requiring access are included in the ACL. *(examples incl: ISE, Catalyst Center, GUEST Network IPv4 etc)*

> [!IMPORTANT]
> **Feedback:** If you found this set of **labs** or **content** helpful, please fill in comments on this feedback form [give feedback](https://github.com/kebaldwi/DNAC-TEMPLATES/discussions/new?category=feedback-and-ideas).</br></br>
**Content Problems and Issues:** If you found an **issue** on the **lab** or **content** please fill in an [issue](https://github.com/kebaldwi/DNAC-TEMPLATES/issues/new) include what file, along with the issue you ran into. 

> [**Return to Main Menu**](../README.md)